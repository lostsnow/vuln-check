package vulnerability

import (
	"fmt"

	"vuln-check/internal/db"
)

type Vulnerability struct {
	Id         int64  `gorm:"primaryKey"`
	Uri        string `json:"uri"`
	StrategyId int64  `json:"strategyId"`
}

func (m *Vulnerability) TableName() string {
	return "iast_vulnerability"
}

func GetVulnerabilities(query *db.MySQLQuery) ([]Vulnerability, error) {
	var v []Vulnerability
	err := query.GetMany((&Vulnerability{}).TableName(), &v)
	if err != nil {
		return nil, fmt.Errorf("get vulnerabilities failed: %w", err)
	}
	return v, nil
}
