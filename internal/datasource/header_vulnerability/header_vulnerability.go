package header_vulnerability

import (
	"fmt"

	"vuln-check/internal/db"
)

type HeaderVulnerability struct {
	Id  int64  `gorm:"primaryKey"`
	Url string `json:"url"`
}

func (m *HeaderVulnerability) TableName() string {
	return "iast_header_vulnerability"
}

func GetHeaderVulnerabilities(query *db.MySQLQuery) ([]HeaderVulnerability, error) {
	var v []HeaderVulnerability
	err := query.GetMany((&HeaderVulnerability{}).TableName(), &v)
	if err != nil {
		return nil, fmt.Errorf("get header vulnerabilities failed: %w", err)
	}
	return v, nil
}
